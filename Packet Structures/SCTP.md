# SCTP Packet Structure

```text
================================================================================
                                SCTP PACKET STRUCTURE
================================================================================

[ IP Packet ]
────────────────────────────────────────────────────────────────────────────────
│
│   SCTP Common Header (12 bytes)
│
│   ┌────────────────────────┬────────────────────────┐
│   │      Source Port       │     Destination Port   │   (2 bytes each)
│   ├─────────────────────────────────────────────────┤
│   │              Verification Tag (4 bytes)         │
│   ├─────────────────────────────────────────────────┤
│   │                   Checksum (4 bytes)            │
│   └─────────────────────────────────────────────────┘
│
│   ┌────────────────────────────────────────────────────────────────────────┐
│   │                               Chunk 1                                  │
│   │  Type(1B) | Flags(1B) | Length(2B) | ............. Chunk Data ........ │
│   └────────────────────────────────────────────────────────────────────────┘
│
│   ┌────────────────────────────────────────────────────────────────────────┐
│   │                               Chunk 2                                  │
│   │  Type(1B) | Flags(1B) | Length(2B) | ............. Chunk Data ........ │
│   └────────────────────────────────────────────────────────────────────────┘
│
│   ┌────────────────────────────────────────────────────────────────────────┐
│   │                               Chunk 3                                  │
│   │  Type(1B) | Flags(1B) | Length(2B) | ............. Chunk Data ........ │
│   └────────────────────────────────────────────────────────────────────────┘
│
────────────────────────────────────────────────────────────────────────────────

※ SCTP 패킷 1개 안에는 여러 개의 Chunk가 동시에 포함될 수 있음



================================================================================
                             SCTP Common Header Fields
================================================================================

Source Port (2 bytes)
 : 송신자 포트
   예시 → 5000

Destination Port (2 bytes)
 : 수신자 포트
   예시 → 3868 (LTE 시그널링)

Verification Tag (4 bytes)
 : 어소시에이션(연결) 식별자
   - 유효하지 않은 연결에서 온 패킷 차단용
   예시 → 0xA1B2C3D4

Checksum (4 bytes)
 : CRC32C 기반 무결성 검증
   예시 → 0xFA67BC21



================================================================================
                               Chunk Common Format
================================================================================

+--------------------------------------------------------------------------+
|  Type (1 byte) | Flags (1 byte) | Length (2 bytes) |   Chunk Data...     |
+--------------------------------------------------------------------------+

Type
 : Chunk 종류

Flags
 : 옵션 및 상태 플래그

Length
 : 해당 Chunk 전체 길이 (Header + Data 포함)



================================================================================
                                Chunk Types
================================================================================

[ Control Chunks ]

INIT         : 어소시에이션 시작 요청
INIT-ACK     : INIT 응답
COOKIE-ECHO  : 쿠키 반환
COOKIE-ACK   : 어소시에이션 성립 완료
SACK         : 수신 확인 응답 (ACK 역할)
HEARTBEAT    : 경로 상태 확인
SHUTDOWN     : 정상 종료
ABORT        : 즉시 종료


[ Data Chunk ]

DATA
 : 실제 사용자 데이터 전송용 Chunk

   필드 구성
   - Stream ID (SID)           : 스트림 번호
   - Stream Sequence Number    : 스트림 내부 순번 (SSN)
   - TSN (Transmission Seq No) : 전체 전송 순번 (TCP Sequence와 동일 개념)
   - Payload Protocol ID
   - User Data (Payload)



================================================================================
                              DATA Chunk Example
================================================================================

Type = DATA
SID  = 1
SSN  = 5
TSN  = 1250

→ Stream 1의 5번째 데이터
→ 전체 전송 흐름 상에서는 1250번째 전송 데이터

================================================================================
                          End-to-End Packet Flow Example
================================================================================

Client → Server

IP Packet
└─ SCTP Packet
   ├─ Verification Tag = 0xA1B2C3D4
   ├─ INIT Chunk           (연결 요청)
   ├─ DATA Chunk (SID = 0) (로그 데이터)
   └─ DATA Chunk (SID = 1) (제어 메시지)

→ 하나의 SCTP 패킷에
   - 연결 제어 정보(Chunk)
   - 다중 스트림 사용자 데이터가 함께 실려 동시에 전송됨
