################################################################################
                              Ethernet II (14 bytes)
################################################################################
+------------------------+------------------------+----------------------+
|    Destination MAC     |       Source MAC       |      EtherType       |
+------------------------+------------------------+----------------------+

Destination MAC (6 bytes): 목적지의 MAC 주소
예시 → ff:ff:ff:ff:ff:ff (브로드캐스트)

Source MAC (6 bytes): 출발지 MAC 주소
예시 → 08:00:27:12:34:56

EtherType (2 bytes): 상위 프로토콜 식별 번호
예시 → 0x0800(IPv4), 0x0806(ARP)


################################################################################
                             ARP Header (28 bytes)
################################################################################
+--------------+--------------+--------------+--------------+
| HardwareType | ProtocolType | HardwareSize | ProtocolSize |
+--------------+--------------+--------------+--------------+
+-----------------------------------------------------------+
|                      Operation                            |
+-----------------------------------------------------------+
+-----------------------------------------------------------+
|                 Sender MAC Address                        |
+-----------------------------------------------------------+
+-----------------------------------------------------------+
|                  Sender IP Address                        |
+-----------------------------------------------------------+
+-----------------------------------------------------------+
|                 Target MAC Address                        |
+-----------------------------------------------------------+
+-----------------------------------------------------------+
|                  Target IP Address                        |
+-----------------------------------------------------------+

HardwareType (2 bytes): 사용되는 네트워크 하드웨어 종류  
예시 → 1 (Ethernet)

ProtocolType (2 bytes): 상위 계층 프로토콜 종류  
예시 → 0x0800 (IPv4)

HardwareSize (1 byte): MAC 주소 길이  
예시 → 6

ProtocolSize (1 byte): IP 주소 길이  
예시 → 4

Operation (2 bytes): 요청/응답 구분  
예시 → 1(ARP Request), 2(ARP Reply)

Sender MAC/IP (6 bytes / 4 bytes): 송신자의 MAC + IP  
예시 → 08:00:27:AA:BB:CC / 192.168.0.10

Target MAC/IP (6 bytes / 4 bytes): 타겟의 MAC + IP  
예시 → 00:00:00:00:00:00 / 192.168.0.1


################################################################################
                          IPv4 Header (20 bytes base)
################################################################################
+--------+--------+--------+--------+-------------------------+
|Version |  IHL   |  DSCP  |  ECN   |      Total Length       |
+--------+--------+--------+--------+-------------------------+
+---------------------------+---------------------------------+
|                      Identification                         |
+---------------------------+---------------------------------+
|              Flags        |   Fragment Offset               |
+---------------------------+---------------------------------+
+-----------+----------------+--------------------------------+
|    TTL    |   Protocol     |       Header Checksum          |
+-----------+----------------+--------------------------------+
+-------------------------------------------------------------+
|                     Source IP Address                       |
+-------------------------------------------------------------+
+-------------------------------------------------------------+
|                  Destination IP Address                     |
+-------------------------------------------------------------+

Version (4bit): IPv4는 4  
예시 → 4

IHL (4bit): 헤더 길이  
예시 → 5 (20 bytes)

DSCP (6bit): 서비스 품질(QoS)  
예시 → 0

ECN (2bit): 혼잡 알림  
예시 → 0

Total Length (2 bytes): 전체 IPv4 패킷 길이  
예시 → 60

Identification (2 bytes): 단편화 ID  
예시 → 0x1c46

Flags (3bit): 단편화 관련 플래그  
예시 → DF=1 (단편화 금지)

Fragment Offset (13bit): 단편화된 조각의 순서  
예시 → 0

TTL (1 byte): 패킷 생존 시간  
예시 → 64

Protocol (1 byte): 상위 전송계층 프로토콜  
예시 → 6(TCP), 17(UDP), 1(ICMP)

Checksum (2 bytes): IPv4 헤더 오류 검출  
예시 → 0xb861

Source/Destination IP (4 bytes each)  
예시 → 192.168.0.10 → 142.250.206.78


################################################################################
                           IPv6 Header (40 bytes)
################################################################################
+----------------------------+-------------------------------+
| Version / Traffic Class /  |          Flow Label           |
+----------------------------+-------------------------------+
+--------------------------+-------------+-------------------+
|      Payload Length      |  NextHdr    |     Hop Limit     |
+--------------------------+-------------+-------------------+
+------------------------------------------------------------+
|                     Source Address                         |
+------------------------------------------------------------+
+------------------------------------------------------------+
|                  Destination Address                       |
+------------------------------------------------------------+

Version: IPv6 버전  
예시 → 6

Traffic Class: 서비스 클래스  
예시 → 0

Flow Label: 흐름 식별자  
예시 → 0x00001

Payload Length: 페이로드 크기  
예시 → 1200

Next Header: 다음 헤더  
예시 → 6(TCP), 17(UDP)

Hop Limit: TTL 역할  
예시 → 128

Source/Destination IPv6 (각 16 bytes)  
예시 → fe80::1ff:fe23:4567:890a


################################################################################
                          TCP Header (20 bytes base)
################################################################################
+--------------------------+--------------------------+
|       Source Port        |     Destination Port     |
+--------------------------+--------------------------+
+-----------------------------------------------------+
|               Sequence Number                       |
+-----------------------------------------------------+
+-----------------------------------------------------+
|            Acknowledgment Number                    |
+-----------------------------------------------------+
+--------------------------+--------------------------+
|   DataOff / Reserved / Flags    |    Window Size    |
+--------------------------+--------------------------+
+--------------------------+--------------------------+
|         Checksum         |       UrgentPtr          |
+--------------------------+--------------------------+
+-----------------------------------------------------+
|                Options (variable)                   |
+-----------------------------------------------------+

Source Port (2 bytes)  
예시 → 53622

Destination Port (2 bytes)  
예시 → 443 (HTTPS)

Sequence Number (4 bytes)  
예시 → 12345678

Acknowledgment Number (4 bytes)  
예시 → 87654321

Data Offset / Reserved / Flags (2 bytes)  
예시 → SYN=1, ACK=0

Window Size (2 bytes)  
예시 → 64240

Checksum (2 bytes)  
Urgent Pointer (2 bytes)


################################################################################
                            UDP Header (8 bytes)
################################################################################
+--------------------------+--------------------------+
|       Source Port        |     Destination Port     |
+--------------------------+--------------------------+
|          Length          |         Checksum         |
+--------------------------+--------------------------+

Source Port (2 bytes)  
예시 → 53

Destination Port (2 bytes)

Length (2 bytes)  
예시 → 48

Checksum (2 bytes)


################################################################################
                          ICMP (Echo Request/Reply)
################################################################################
+---------------+---------------+-------------------------------+
|     Type      |      Code     |           Checksum            |
+---------------+---------------+-------------------------------+
|           Rest of Header (32 bits, message specific)          |
+---------------------------------------------------------------+
|                    (추가 데이터 / Payload ...)                   |
+---------------------------------------------------------------+

Type (1 byte)  
예시 → 8(Ping 요청), 0(Ping 응답)

Code (1 byte)  
예시 → 0

Checksum (2 bytes)

Rest of Header (4 bytes)  
예시 → Identifier + Sequence Number

Payload (가변 길이)  
예시 → ping 테스트 데이터


################################################################################
                               IGMPv2 (8 bytes)
################################################################################
+-----------+----------------+------------------------+
|   Type    | MaxRespTime    |       Checksum         |
+-----------+----------------+------------------------+
+-----------------------------------------------------+
|                  Group Address                      |
+-----------------------------------------------------+

Type (1 byte)  
예시 → 0x16

MaxRespTime (1 byte)  
예시 → 100 (10초)

Checksum (2 bytes)

Group Address (4 bytes)  
예시 → 224.0.0.1


############################################################
                 DNS Header (12 bytes)
############################################################
+------------------------+-------------------------------+
|           ID (16 bits, Query ID)                       |
+----+---------+----+----+----+------+-------------------+
| QR | Opcode  | AA | TC | RD |  RA  |   Z   |   RCODE   |
|1bit| 4 bits  |1bit|1bit|1bit| 1bit | 3bits |   4 bits  |
+------------------------+-------------------------------+
|                 QDCOUNT (16 bits)                      |
+--------------------------------------------------------+
|                 ANCOUNT (16 bits)                      |
+--------------------------------------------------------+
|                 NSCOUNT (16 bits)                      |
+--------------------------------------------------------+
|                 ARCOUNT (16 bits)                      |
+--------------------------------------------------------+

ID (16 bits)
→ DNS 요청/응답을 매칭하기 위한 고유 식별자
예시: 0x1a2b

QR (1 bit)
→ 0 = Query, 1 = Response
예시: 0 (Query)

Opcode (4 bits)
→ 질의 타입 (일반적으로 0 = 표준쿼리)
예시: 0

AA (Authoritative Answer, 1 bit)
→ 응답이 권한 있는 네임서버로부터 온 경우 1
예시: 0

TC (Truncation, 1 bit)
→ 패킷이 너무 커서 잘렸는지 여부
예시: 0

RD (Recursion Desired, 1 bit)
→ 클라이언트가 재귀 질의를 원하는지
예시: 1

RA (Recursion Available, 1 bit)
→ 서버가 재귀 질의를 지원하는지
예시: 1

Z (3 bits)
→ 항상 0 (예약 필드)
예시: 000

RCODE (4 bits)
→ 응답 코드 (0=정상, 3=Name Error 등)
예시: 0

QDCOUNT (16 bits)
→ Question Section의 항목 개수
예시: 1

ANCOUNT (16 bits)
→ Answer Section의 Resource Record 개수
예시: 1

NSCOUNT (Authority Count, 16 bits)
→ Authority Section의 RR 개수
예시: 0

ARCOUNT (Additional Count, 16 bits)
→ Additional Section의 RR 개수
예시: 0


################################################################################
                             DHCPv4 (기본 구조 일부)
################################################################################
+-----------------+---------------------+---------------------+-------------------+
|       Op        |       HType         |       HLen          |       Hops        |
+-----------------+---------------------+---------------------+-------------------+
|                                  Transaction ID                                 |
+---------------------------------------------------------------------------------+
|             Seconds Elapsed           |                 Flags                   |
+---------------------------------------------------------------------------------+
|                         Client IP Address                                       |
+---------------------------------------------------------------------------------+
|                         Your IP Address                                         |
+---------------------------------------------------------------------------------+
|                         Server IP Address                                       |
+---------------------------------------------------------------------------------+
|                         Gateway IP Address                                      |
+---------------------------------------------------------------------------------+
|                         Client Hardware Address                                 |
+---------------------------------------------------------------------------------+
|                         Server Host Name                                        |
+---------------------------------------------------------------------------------+
|                         Boot File Name                                          |
+---------------------------------------------------------------------------------+
|                         Options (variable)                                      |
+---------------------------------------------------------------------------------+
Op (1 byte)
DHCP 패킷이 요청인지 응답인지 지정한다.
예시 → 1 = BOOTREQUEST(클라이언트 → 서버) / 2 = BOOTREPLY(서버 → 클라이언트)

Hardware Type / HType (1 byte)
사용되는 네트워크(MAC) 타입.
예시 → 1 = Ethernet

Hardware Length / HLen (1 byte)
MAC 주소 길이.
예시 → 6

Hops (1 byte)
Relay Agent가 중계할 때 hop count 증가.
예시 → 0

Transaction ID / XID (4 bytes)
요청~응답을 묶기 위한 난수 ID.
예시 → 0x3903F326

Seconds Elapsed (2 bytes)
클라이언트가 처음 DHCP 요청을 보낸 뒤 경과한 시간.
예시 → 0x0005

Flags (2 bytes)
Broadcast 전송 여부 등.
예시 → 0x8000 (Broadcast 플래그 ON)

Client IP Address (ciaddr, 4 bytes)
이미 IP가 있을 때 채워짐(renew).
예시 → 0.0.0.0

Your IP Address (yiaddr, 4 bytes)
서버가 클라이언트에게 “할당해주는 IP”.
예시 → 192.168.10.100

Server IP Address (siaddr, 4 bytes)
DHCP 서버 주소.
예시 → 192.168.10.1

Gateway IP Address (giaddr, 4 bytes)
Relay Agent가 있을 때 사용.
예시 → 0.0.0.0

Client Hardware Address (chaddr, 16 bytes)
클라이언트 MAC 주소.
앞 6바이트가 MAC, 나머지는 0으로 채움.
예시 → 08:00:27:12:34:56

Server Host Name (sname, 64 bytes)
서버 이름 문자열(옵션).
예시 → "" (공백)

Boot File Name (file, 128 bytes)
PXE 같은 네트워크 부팅 파일 이름.
예시 → "pxelinux.0"

Options (가변 길이)
DHCP의 핵심 정보들이 여기 담긴다.
예시(중요 옵션):
	•	53: DHCP Message Type
	•	1=Discover, 2=Offer, 3=Request, 5=ACK, 6=NAK 등
	•	50: Requested IP
	•	54: DHCP Server Identifier
	•	51: Lease Time
	•	1: Subnet Mask
	•	3: Router(Gateway)
	•	6: DNS 서버


################################################################################
                          TLS Record Layer (5 bytes)
################################################################################
+-----------+----------------+------------------------+
|ContentType|    Version     |        Length          |
+-----------+----------------+------------------------+
+-----------------------------------------------------+
|               Encrypted Fragment...                 |
+-----------------------------------------------------+

ContentType (1 byte)  
예시 → 23 (암호화된 Application Data)

Version (2 bytes)  
예시 → 0x0303 (TLS1.2)

Length (2 bytes)  
예시 → 517

################################################################################
                            MPLS Header (4 bytes)
################################################################################
+---------------------------+---------+-----+------------+
|          Label            |   TC    |  S  |    TTL     |
+---------------------------+---------+-----+------------+

Label (20 bits)
- 목적지까지의 라벨 기반 경로 식별자
예시 → 299792

TC (Traffic Class, 옛 EXP) (3 bits)
- MPLS 패킷이 얼마나 중요한지(우선순위) 표시하는 3비트 QoS 필드이다.
- QoS/CoS 또는 ECN 표시
예시 → 0b000

S (Bottom of Stack, 1 bit)
- 라벨 스택의 마지막 라벨이면 1
예시 → 1

TTL (8 bits)
- 홉마다 감소하여 루프 방지
예시 → 64
